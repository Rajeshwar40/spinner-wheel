<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Spinner Wheel (Clean)</title>
<style>
  html, body { height:100%; }
  body { margin:0; background:#0a0a0a; color:#e5e5e5; font-family: Arial, Helvetica, sans-serif; }
  .wrap { max-width:900px; margin:0 auto; padding:20px; }
  .card { background:#121212; border-radius:16px; padding:18px; }
  .row { display:flex; align-items:center; justify-content:space-between; gap:12px; }
  .btn { background:#10b981; border:0; color:#fff; padding:10px 18px; border-radius:999px; cursor:pointer; font-weight:bold; }
  .btn.secondary { background:#2a2a2a; }
  .wheel-area { position:relative; display:flex; justify-content:center; margin-top:12px; }
  .pointer { position:absolute; left:50%; transform:translateX(-50%); top:6%; width:0; height:0; border-left:18px solid transparent; border-right:18px solid transparent; border-top:40px solid #ffffff; z-index:5; }
  .wheel { position:relative; width:520px; max-width:100%; aspect-ratio:1/1; margin:0 auto; border-radius:50%; background:#1f2937; overflow:hidden; }
  .hub { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none; }
  .hub div { width:64px; height:64px; background:#fff; border-radius:50%; box-shadow: inset 0 0 10px rgba(0,0,0,0.4); }
  .winner { text-align:center; font-size:18px; margin-top:10px; min-height:24px; }
  #admin { display:none; margin-top:14px; }
  textarea { width:100%; height:220px; background:#1c1c1c; color:#e5e5e5; border:1px solid #2f2f2f; border-radius:12px; padding:10px; resize:vertical; }
  label { color:#a3a3a3; font-size:14px; display:inline-flex; align-items:center; gap:8px; }
  input[type="number"] { width:100px; background:#1c1c1c; color:#e5e5e5; border:1px solid #2f2f2f; border-radius:8px; padding:6px 8px; }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="row">
      <h1 style="margin:0; font-size:22px;">Spinner Wheel</h1>
      <div>
        <button id="spin" class="btn">Spin</button>
        <button id="reset" class="btn secondary">Reset</button>
      </div>
    </div>

    <div class="wheel-area">
      <div class="pointer"></div>
      <div class="wheel">
        <svg id="wheelSvg" viewBox="0 0 100 100" style="width:100%; height:100%;">
          <g id="slices" transform="translate(50,50)"></g>
        </svg>
        <div class="hub"><div></div></div>
      </div>
    </div>
    <div id="winTxt" class="winner"></div>
  </div>

  <div id="admin" class="card">
    <h2 style="margin-top:0; font-size:18px;">Admin Panel</h2>
    <div style="display:grid; gap:12px; grid-template-columns:1fr 1fr;">
      <div>
        <label>Names (one per line)</label>
        <textarea id="namesTa">Arjun
Vikrant
Sanjay
Shreya
Shivanshu
Rajeshwar
Rohit
Mohit
Manikanta
Kaushiki</textarea>
        <div style="margin-top:10px;">
          <button id="shuffle" class="btn" style="background:#3b82f6;">Shuffle</button>
          <button id="closeAdmin" class="btn secondary">Close</button>
        </div>
      </div>
      <div>
        <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:8px;">
          <label><input type="checkbox" id="rig" checked> Bias to 4th (rig)</label>
          <label>Duration <input id="duration" type="number" min="1000" max="15000" step="500" value="5000"> ms</label>
        </div>
        <p style="color:#a3a3a3; font-size:13px;">Toggle Admin with Ctrl+Alt+R.</p>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  var palette = ["#1e3a8a","#ef4444","#f59e0b","#16a34a"];
  var startAngle = -90;
  var spinning = false;

  function degToRad(d){ return d*Math.PI/180; }
  function getNames(){
    var raw = document.getElementById("namesTa").value;
    var lines = raw.split(/\r?\n/);
    var out = [];
    for(var i=0;i<lines.length;i++){
      var s = lines[i].trim();
      if(s){ out.push(s); }
    }
    return out;
  }

  function drawWheel(){
    var names = getNames();
    var g = document.getElementById("slices");
    g.innerHTML = "";
    if(names.length === 0) return;
    var seg = 360 / names.length;
    var r = 48;

    for(var i=0;i<names.length;i++){
      var a0 = degToRad(i*seg + startAngle);
      var a1 = degToRad((i+1)*seg + startAngle);
      var x0 = r*Math.cos(a0), y0 = r*Math.sin(a0);
      var x1 = r*Math.cos(a1), y1 = r*Math.sin(a1);
      var large = (seg > 180) ? 1 : 0;
      var pathStr = "M0 0 L "+x0.toFixed(3)+" "+y0.toFixed(3)+" A "+r+" "+r+" 0 "+large+" 1 "+x1.toFixed(3)+" "+y1.toFixed(3)+" Z";
      var mid = degToRad(i*seg + startAngle + seg/2);
      var tx = (r*0.65)*Math.cos(mid);
      var ty = (r*0.65)*Math.sin(mid);

      var slice = document.createElementNS("http://www.w3.org/2000/svg","g");
      var p = document.createElementNS("http://www.w3.org/2000/svg","path");
      p.setAttribute("d", pathStr);
      p.setAttribute("fill", palette[i%palette.length]);
      p.setAttribute("stroke", "#111");
      p.setAttribute("stroke-width", "0.5");
      slice.appendChild(p);

      var t = document.createElementNS("http://www.w3.org/2000/svg","text");
      t.setAttribute("x", tx);
      t.setAttribute("y", ty);
      t.setAttribute("fill", "#fff");
      t.setAttribute("dominant-baseline","middle");
      t.setAttribute("text-anchor","middle");
      var fontSize = Math.max(6, 14 - Math.max(0, names.length-6));
      t.setAttribute("font-size", fontSize);
      t.setAttribute("transform", "rotate("+(i*seg + startAngle + seg/2)+" "+tx+" "+ty+")");
      t.appendChild(document.createTextNode(names[i]));
      slice.appendChild(t);

      g.appendChild(slice);
    }
  }

  function angleForIndex(i, seg){
    var center = startAngle + i*seg + seg/2;
    var pointerAngle = -90;
    return pointerAngle - center;
  }

  function spin(){
    if(spinning) return;
    var names = getNames();
    if(names.length===0) return;
    var seg = 360/names.length;
    var rig = document.getElementById("rig").checked;
    var forcedIndex = 3;
    var targetIndex = (rig && names.length>forcedIndex) ? forcedIndex : Math.floor(Math.random()*names.length);
    var extraSpins = 8 + Math.floor(Math.random()*4);
    var delta = angleForIndex(targetIndex, seg) + extraSpins*360;

    var svg = document.getElementById("wheelSvg");
    spinning = true;
    svg.style.transition = "transform "+Number(document.getElementById("duration").value)+"ms cubic-bezier(0.2, 0.9, 0.2, 1)";
    svg.style.transform = "rotate("+delta+"deg)";
    (function(idx){
      setTimeout(function(){
        spinning = false;
        document.getElementById("winTxt").innerHTML = "Winner: <span style='color:#10b981; font-weight:bold;'>"+ (names[idx]||"") +"</span>";
      }, Number(document.getElementById("duration").value)+50);
    })(targetIndex);
  }

  function resetWheel(){
    var svg = document.getElementById("wheelSvg");
    svg.style.transition = "none";
    svg.style.transform = "rotate(0deg)";
    document.getElementById("winTxt").textContent = "";
  }

  function toggleAdmin(){
    var panel = document.getElementById("admin");
    panel.style.display = (panel.style.display === "block") ? "none" : "block";
  }

  // events
  document.getElementById("spin").addEventListener("click", spin);
  document.getElementById("reset").addEventListener("click", resetWheel);
  document.getElementById("namesTa").addEventListener("input", drawWheel);
  document.getElementById("shuffle").addEventListener("click", function(){
    var names = getNames();
    for(var i=names.length-1;i>0;i--){ var j=Math.floor(Math.random()*(i+1)); var tmp=names[i]; names[i]=names[j]; names[j]=tmp; }
    document.getElementById("namesTa").value = names.join("\n");
    drawWheel();
  });
  document.getElementById("closeAdmin").addEventListener("click", function(){ document.getElementById("admin").style.display="none"; });

  document.addEventListener("keydown", function(e){
    if(e.ctrlKey && e.altKey && (e.key === "r" || e.key === "R")){
      e.preventDefault();
      toggleAdmin();
    }
  });

  drawWheel();
})();
</script>
</body>
</html>
